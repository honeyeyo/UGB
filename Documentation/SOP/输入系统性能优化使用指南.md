# ğŸš€ PongHubè¾“å…¥ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—è¯´æ˜å¦‚ä½•ä½¿ç”¨PongHubè¾“å…¥ç³»ç»Ÿçš„æ€§èƒ½ä¼˜åŒ–åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ€§èƒ½ç›‘æ§ã€åŸºå‡†æµ‹è¯•å’Œä¼˜åŒ–é…ç½®ã€‚

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### 1. å¯ç”¨æ€§èƒ½ä¼˜åŒ–

åœ¨Unityç¼–è¾‘å™¨ä¸­é€‰æ‹©åŒ…å«`PongHubInputManager`çš„GameObjectï¼Œåœ¨Inspectoré¢æ¿ä¸­ï¼š

1. **å±•å¼€"ğŸš€ æ€§èƒ½ä¼˜åŒ–è®¾ç½®"é¢æ¿**
2. **å‹¾é€‰"å¯ç”¨ä¼˜åŒ–è½®è¯¢"** - è¿™å°†æ¿€æ´»90Hzé™é¢‘ä¼˜åŒ–
3. **è®¾ç½®"è¿ç»­è¾“å…¥æ›´æ–°é¢‘ç‡"** - æ¨èVRç¯å¢ƒä½¿ç”¨90Hz
4. **å¯é€‰ï¼šå‹¾é€‰"å¯ç”¨æ€§èƒ½æ—¥å¿—"** - ä»…åœ¨éœ€è¦è¯¦ç»†è°ƒè¯•æ—¶å¼€å¯

### 2. å®æ—¶æ€§èƒ½ç›‘æ§

è¿è¡Œæ¸¸æˆåï¼Œåœ¨Inspectoré¢æ¿ä¸­å¯ä»¥çœ‹åˆ°ï¼š

- **ğŸ“Š å®æ—¶æ€§èƒ½ç»Ÿè®¡é¢æ¿**
- **CPUæ—¶é—´æ˜¾ç¤º** (ç»¿è‰²<20Î¼sï¼Œé»„è‰²20-50Î¼sï¼Œçº¢è‰²>50Î¼s)
- **å®é™…æ›´æ–°é¢‘ç‡**
- **æ€§èƒ½è¯„çº§** (A+ åˆ° D)

### 3. æ¸¸æˆå†…æ€§èƒ½ç›‘æ§

æ·»åŠ `InputPerformanceMonitor`ç»„ä»¶åˆ°ä»»æ„GameObjectï¼š

```csharp
// è‡ªåŠ¨æ·»åŠ æ€§èƒ½ç›‘æ§
var perfMonitor = gameObject.AddComponent<InputPerformanceMonitor>();
perfMonitor.m_showInGameUI = true; // æ˜¾ç¤ºæ¸¸æˆå†…UI
```

**å¿«æ·é”®æ“ä½œï¼š**

- `F9` - åˆ‡æ¢æ€§èƒ½ç›‘æ§UIæ˜¾ç¤º
- `F8` - å¼€å§‹/åœæ­¢åŸºå‡†æµ‹è¯•

## ğŸ“Š åŸºå‡†æµ‹è¯•

### ä½¿ç”¨InputPerformanceBenchmark

1. **æ·»åŠ åŸºå‡†æµ‹è¯•ç»„ä»¶**

   ```csharp
   var benchmark = gameObject.AddComponent<InputPerformanceBenchmark>();
   ```

2. **è¿è¡Œå•æ¬¡åŸºå‡†æµ‹è¯•**

   - æŒ‰`F8`é”®å¼€å§‹æµ‹è¯•
   - ç­‰å¾…10ç§’ï¼ˆå¯é…ç½®ï¼‰è‡ªåŠ¨å®Œæˆ
   - æŸ¥çœ‹Consoleè¾“å‡ºçš„è¯¦ç»†æŠ¥å‘Š

3. **è¿è¡Œå¯¹æ¯”æµ‹è¯•**

   ```csharp
   benchmark.RunComparisonTest(); // è‡ªåŠ¨å¯¹æ¯”ä¼˜åŒ–å‰åæ€§èƒ½
   ```

### åŸºå‡†æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹

```text
ğŸš€ PongHubè¾“å…¥ç³»ç»Ÿæ€§èƒ½åŸºå‡†æµ‹è¯•æŠ¥å‘Š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æµ‹è¯•é…ç½®:
- æµ‹è¯•æ—¶é•¿: 10ç§’
- æ ·æœ¬æ•°é‡: 900
- ä¼˜åŒ–æ¨¡å¼: å¯ç”¨
- ç›®æ ‡é¢‘ç‡: 90.0Hz

CPUæ€§èƒ½æŒ‡æ ‡:
- å¹³å‡CPUæ—¶é—´: 12.3Î¼s
- æœ€å°CPUæ—¶é—´: 8.1Î¼s
- æœ€å¤§CPUæ—¶é—´: 18.7Î¼s
- 50thç™¾åˆ†ä½: 11.8Î¼s
- 95thç™¾åˆ†ä½: 15.2Î¼s
- 99thç™¾åˆ†ä½: 17.1Î¼s

å¸§ç‡æ€§èƒ½:
- å¹³å‡FPS: 89.7
- å¹³å‡å¸§æ—¶é—´: 11.15ms

æ€§èƒ½è¯„çº§: è‰¯å¥½ (A) - æ¨èä½¿ç”¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

## âš™ï¸ æ€§èƒ½é…ç½®è¯¦è§£

### ä¼˜åŒ–è½®è¯¢è®¾ç½®

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ | å»ºè®®å€¼ |
|------|--------|------|--------|
| `m_useOptimizedPolling` | `true` | å¯ç”¨ä¼˜åŒ–è½®è¯¢æ¨¡å¼ | VR: `true`, æ¡Œé¢: `å¯é€‰` |
| `m_continuousInputUpdateRate` | `90Hz` | è¿ç»­è¾“å…¥æ›´æ–°é¢‘ç‡ | VR: `90Hz`, æ¡Œé¢: `60Hz` |
| `m_enablePerformanceLogging` | `false` | è¯¦ç»†æ€§èƒ½æ—¥å¿— | è°ƒè¯•æ—¶: `true`, å‘å¸ƒ: `false` |

### æ€§èƒ½ç­‰çº§è¯´æ˜

| ç­‰çº§ | CPUæ—¶é—´èŒƒå›´ | æè¿° | é€‚ç”¨åœºæ™¯ |
|------|-------------|------|----------|
| A+ | < 10Î¼s | ä¼˜ç§€ - VRå°±ç»ª | é«˜ç«¯VRè®¾å¤‡ |
| A | 10-20Î¼s | è‰¯å¥½ - æ¨èä½¿ç”¨ | å¤§å¤šæ•°VRè®¾å¤‡ |
| B | 20-50Î¼s | ä¸­ç­‰ - å¯æ¥å— | æ¡Œé¢åº”ç”¨ |
| C | 50-100Î¼s | è¾ƒå·® - éœ€è¦ä¼˜åŒ– | éœ€è¦è°ƒä¼˜ |
| D | > 100Î¼s | å¾ˆå·® - ä¸¥é‡æ€§èƒ½é—®é¢˜ | å¿…é¡»ä¼˜åŒ– |

## ğŸ”§ æ€§èƒ½è°ƒä¼˜å»ºè®®

### VRç¯å¢ƒä¼˜åŒ–

1. **å¯ç”¨ä¼˜åŒ–è½®è¯¢**

   ```csharp
   PongHubInputManager.Instance.m_useOptimizedPolling = true;
   ```

2. **è®¾ç½®é€‚å½“çš„æ›´æ–°é¢‘ç‡**

   ```csharp
   // Quest 2/3: 90Hz
   // Quest Pro: 90Hz
   // Pico 4: 90Hz
   // Index: 120Hz (å¦‚æœéœ€è¦)
   ```

3. **å…³é—­å‘å¸ƒç‰ˆæœ¬çš„æ€§èƒ½æ—¥å¿—**

   ```csharp
   #if UNITY_EDITOR || DEVELOPMENT_BUILD
   PongHubInputManager.Instance.m_enablePerformanceLogging = true;
   #else
   PongHubInputManager.Instance.m_enablePerformanceLogging = false;
   #endif
   ```

### æ¡Œé¢ç¯å¢ƒä¼˜åŒ–

1. **å¯é€‰æ‹©æ€§å¯ç”¨ä¼˜åŒ–**

   - é«˜åˆ·æ–°ç‡æ˜¾ç¤ºå™¨ï¼ˆ120Hz+ï¼‰å»ºè®®å¯ç”¨
   - 60Hzæ˜¾ç¤ºå™¨å¯ä»¥ç¦ç”¨ä»¥å‡å°‘å»¶è¿Ÿ

2. **è°ƒæ•´æ›´æ–°é¢‘ç‡**

   ```csharp
   // 60Hzæ˜¾ç¤ºå™¨
   m_continuousInputUpdateRate = 60f;
   // 120Hzæ˜¾ç¤ºå™¨
   m_continuousInputUpdateRate = 120f;
   ```

## ğŸ“ˆ æ€§èƒ½ç›‘æ§æœ€ä½³å®è·µ

### 1. å®šæœŸåŸºå‡†æµ‹è¯•

```csharp
// åœ¨ä¸åŒåœºæ™¯ä¸­è¿è¡Œæµ‹è¯•
void RunPerformanceValidation()
{
    var benchmark = FindObjectOfType<InputPerformanceBenchmark>();
    if (benchmark != null)
    {
        benchmark.StartBenchmark();
    }
}
```

### 2. æ€§èƒ½å›å½’æ£€æµ‹

```csharp
// CI/CDä¸­çš„æ€§èƒ½æµ‹è¯•
[Test]
public void InputPerformanceRegressionTest()
{
    var benchmark = new GameObject().AddComponent<InputPerformanceBenchmark>();
    benchmark.m_testDuration = 5; // çŸ­æµ‹è¯•
    benchmark.RunComparisonTest();

    // æ£€æŸ¥æ€§èƒ½æ˜¯å¦é€€åŒ–
    string results = benchmark.GetLastTestResults();
    Assert.IsTrue(results.Contains("è‰¯å¥½") || results.Contains("ä¼˜ç§€"));
}
```

### 3. è¿è¡Œæ—¶æ€§èƒ½ç›‘æ§

```csharp
// æ¸¸æˆè¿è¡Œæ—¶çš„æ€§èƒ½è­¦å‘Š
void Update()
{
    if (PongHubInputManager.Instance.LastFrameCPUTime > 50f)
    {
        Debug.LogWarning($"è¾“å…¥ç³»ç»Ÿæ€§èƒ½è­¦å‘Š: {PongHubInputManager.Instance.LastFrameCPUTime:F1}Î¼s");
    }
}
```

## ğŸ› å¸¸è§é—®é¢˜

### Q: æ€§èƒ½ç›‘æ§æ˜¾ç¤º"ç­‰å¾…è¿è¡Œæ—¶æ•°æ®"

**A**: ç¡®ä¿

1. æ¸¸æˆæ­£åœ¨è¿è¡Œï¼ˆPlayæ¨¡å¼ï¼‰
2. `PongHubInputManager`å®ä¾‹å­˜åœ¨
3. è¾“å…¥ç³»ç»Ÿå·²æ­£ç¡®åˆå§‹åŒ–

### Q: ä¼˜åŒ–åæ€§èƒ½æ²¡æœ‰æ˜æ˜¾æå‡

**A**: æ£€æŸ¥

1. æ˜¯å¦çœŸæ­£å¯ç”¨äº†ä¼˜åŒ–æ¨¡å¼
2. æ›´æ–°é¢‘ç‡è®¾ç½®æ˜¯å¦åˆç†
3. æ˜¯å¦æœ‰å…¶ä»–ç³»ç»Ÿå ç”¨CPUèµ„æº

### Q: VRä¸­å‡ºç°è¾“å…¥å»¶è¿Ÿ

**A**: è°ƒæ•´è®¾ç½®

1. é™ä½`m_continuousInputUpdateRate`åˆ°60Hz
2. ç¡®ä¿VRè®¾å¤‡è¿è¡Œåœ¨ç¨³å®šå¸§ç‡
3. æ£€æŸ¥æ˜¯å¦æœ‰GCåˆ†é…å¯¼è‡´çš„å¡é¡¿

## ğŸ“š APIå‚è€ƒ

### PongHubInputManager

```csharp
// æ€§èƒ½ç›¸å…³å±æ€§
public float LastFrameCPUTime { get; } // æœ€åä¸€å¸§CPUæ—¶é—´(Î¼s)
public float ActualUpdateRate { get; } // å®é™…æ›´æ–°é¢‘ç‡(Hz)
public bool m_useOptimizedPolling; // å¯ç”¨ä¼˜åŒ–è½®è¯¢
public bool m_enablePerformanceLogging; // å¯ç”¨æ€§èƒ½æ—¥å¿—

// æ€§èƒ½æ–¹æ³•
public string GetPerformanceStats(); // è·å–æ€§èƒ½ç»Ÿè®¡ä¿¡æ¯
```

### InputPerformanceMonitor

```csharp
// æ§åˆ¶æ–¹æ³•
public void ToggleUI(); // åˆ‡æ¢UIæ˜¾ç¤º
public string GetCurrentStats(); // è·å–å½“å‰ç»Ÿè®¡ä¿¡æ¯
```

### InputPerformanceBenchmark

```csharp
// åŸºå‡†æµ‹è¯•æ–¹æ³•
public void StartBenchmark(); // å¼€å§‹åŸºå‡†æµ‹è¯•
public void StopBenchmark(); // åœæ­¢åŸºå‡†æµ‹è¯•
public void RunComparisonTest(); // è¿è¡Œå¯¹æ¯”æµ‹è¯•
public string GetLastTestResults(); // è·å–æœ€åæµ‹è¯•ç»“æœ
```

## ğŸ”„ ç‰ˆæœ¬å†å²

- **v1.0** - åˆå§‹ä¼˜åŒ–å®ç°ï¼Œ90Hzé™é¢‘è½®è¯¢
- **v1.1** - æ·»åŠ æ€§èƒ½ç›‘æ§å’ŒåŸºå‡†æµ‹è¯•å·¥å…·
- **v1.2** - å¢å¼ºçš„ç¼–è¾‘å™¨UIå’Œå®æ—¶ç»Ÿè®¡

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°æ€§èƒ½é—®é¢˜ï¼Œè¯·æä¾›

1. åŸºå‡†æµ‹è¯•æŠ¥å‘Š
2. è®¾å¤‡è§„æ ¼ä¿¡æ¯
3. Unityç‰ˆæœ¬å’Œé¡¹ç›®è®¾ç½®
4. å…·ä½“çš„æ€§èƒ½è¡¨ç°æè¿°

---

## æœ¬æŒ‡å—åŸºäºPongHubè¾“å…¥ç³»ç»Ÿv1.2ç‰ˆæœ¬ç¼–å†™
