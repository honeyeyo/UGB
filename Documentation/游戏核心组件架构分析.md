# æ¸¸æˆæ ¸å¿ƒç»„ä»¶æ¶æ„åˆ†æ

## é—®é¢˜åˆ†æ

### 1. ä¸ºä»€ä¹ˆBallæ²¡æœ‰åƒTableå’ŒPaddleé‚£æ ·çš„ç›´æ¥åŸºç¡€ç±»ï¼Ÿ

#### ğŸ“Š **å½“å‰æ¶æ„å¯¹æ¯”**

| ç»„ä»¶ | åŸºç¡€ç±» | ç‰¹ç‚¹ |
|------|--------|------|
| **Table** | `Table.cs` | âœ… æœ‰ç»Ÿä¸€çš„åŸºç¡€ç±» |
| **Paddle** | `Paddle.cs` | âœ… æœ‰ç»Ÿä¸€çš„åŸºç¡€ç±» |
| **Ball** | âŒ **ç¼ºå¤±** | åˆ†æ•£ä¸ºå¤šä¸ªä¸“ä¸šåŒ–ç»„ä»¶ |

#### ğŸ” **Ballç»„ä»¶åˆ†æ**

å½“å‰Ballç³»ç»Ÿè¢«åˆ†è§£ä¸ºå¤šä¸ªä¸“ä¸šåŒ–ç»„ä»¶ï¼š

- `BallPhysics.cs` - ç‰©ç†è¡Œä¸º
- `BallNetworking.cs` - ç½‘ç»œåŒæ­¥
- `BallPrefab.cs` - ç»„ä»¶æ•´åˆ
- `BallSpawner.cs` - ç”Ÿæˆç®¡ç†
- `BallStateSync.cs` - çŠ¶æ€åŒæ­¥
- `BallSpin.cs` - æ—‹è½¬ç³»ç»Ÿ
- `BallAttachment.cs` - é™„ç€ç³»ç»Ÿ

#### âš¡ **é—®é¢˜è¯Šæ–­**

è¿™ç§è®¾è®¡å­˜åœ¨é—®é¢˜ï¼š

1. **ç¼ºä¹ç»Ÿä¸€æ¥å£**ï¼šæ²¡æœ‰ç»Ÿä¸€çš„BallåŸºç¡€ç±»ä½œä¸ºå…¥å£ç‚¹
2. **ç»„ä»¶è€¦åˆ**ï¼šå„ç»„ä»¶é—´å¯èƒ½å­˜åœ¨è€¦åˆå…³ç³»
3. **ä½¿ç”¨å¤æ‚**ï¼šå¤–éƒ¨ç³»ç»Ÿéœ€è¦çŸ¥é“å…·ä½“ä½¿ç”¨å“ªä¸ªç»„ä»¶
4. **ä¸ä¸€è‡´æ€§**ï¼šä¸Tableã€Paddleçš„è®¾è®¡æ¨¡å¼ä¸ä¸€è‡´

### 2. Tableä½œä¸ºæœ¬åœ°ç©ºé—´é”šç‚¹

#### ğŸ¯ **æ­£ç¡®çš„æ¶æ„ç†è§£**

> "Tableæ˜¯ç©å®¶æœ¬åœ°VRç©ºé—´çš„é”šç‚¹ï¼Œä¸éœ€è¦ç½‘ç»œåŒæ­¥"

#### ğŸ“ **Tableä½œä¸ºæœ¬åœ°é”šç‚¹çš„ä»·å€¼**

```mermaid
graph TD
    A[ç©å®¶Açš„æœ¬åœ°ç©ºé—´] --> C[æœ¬åœ°Tableé”šç‚¹]
    B[ç©å®¶Bçš„æœ¬åœ°ç©ºé—´] --> D[æœ¬åœ°Tableé”šç‚¹]
    C --> E[ç›¸å¯¹åæ ‡è®¡ç®—]
    D --> E
    E --> F[æ¸¸æˆé€»è¾‘ä¸€è‡´æ€§]
```

#### âœ… **Tableçš„æ­£ç¡®èŒè´£**

1. **æœ¬åœ°ç©ºé—´å‚è€ƒ**ï¼šä½œä¸ºç©å®¶æˆ¿é—´çš„ç‰©ç†é”šç‚¹
2. **ç¢°æ’æ£€æµ‹**ï¼šæä¾›çƒæ¡Œç‰©ç†è¾¹ç•Œ
3. **åæ ‡è½¬æ¢**ï¼šæä¾›ä¸–ç•Œç©ºé—´åˆ°æœ¬åœ°ç©ºé—´çš„è½¬æ¢
4. **æ¸¸æˆé€»è¾‘**ï¼šå¤„ç†å‘çƒã€å¾—åˆ†ç­‰æ¸¸æˆè§„åˆ™

#### âŒ **ä¸éœ€è¦ç½‘ç»œåŒæ­¥çš„åŸå› **

Tableä½œä¸ºæœ¬åœ°é”šç‚¹ï¼Œä¸åº”è¯¥è¿›è¡Œç½‘ç»œåŒæ­¥ï¼š

- **VRç©ºé—´å·®å¼‚**ï¼šä¸åŒç©å®¶çš„æˆ¿é—´å¤§å°å’Œå¸ƒå±€ä¸åŒ
- **æœ¬åœ°è®¾ç½®**ï¼šæ¯ä¸ªç©å®¶éƒ½æœ‰è‡ªå·±çš„èˆ’é€‚ä½ç½®
- **ç‰©ç†ç›´è§‰**ï¼šTableä¸åº”è¯¥å› ä¸ºå…¶ä»–ç©å®¶è€Œç§»åŠ¨

### 3. éŸ³æ•ˆåº”è¯¥ç”±Ballåˆ¤æ–­å’Œè§¦å‘

#### ğŸ¯ **ä½ çš„å»ºè®®å®Œå…¨æ­£ç¡®**

éŸ³æ•ˆåº”è¯¥ç”±çƒæ¥åˆ¤æ–­ç¢°æ’çŠ¶æ€å¹¶å‘å£°ï¼ŒåŸå› ï¼š

1. **é€»è¾‘é›†ä¸­**ï¼šçƒæ˜¯ç¢°æ’çš„ä¸»ä½“ï¼Œæœ€æ¸…æ¥šç¢°æ’æƒ…å†µ
2. **é¿å…é‡å¤**ï¼šé˜²æ­¢å¤šä¸ªå¯¹è±¡åŒæ—¶æ’­æ”¾éŸ³æ•ˆ
3. **æ•°æ®å¯é **ï¼šçƒæœ‰å®Œæ•´çš„ç¢°æ’ä¿¡æ¯ï¼ˆé€Ÿåº¦ã€è§’åº¦ã€åŠ›åº¦ï¼‰
4. **ç½‘ç»œæ•ˆç‡**ï¼šå‡å°‘ä¸å¿…è¦çš„RPCè°ƒç”¨

## æ”¹è¿›å»ºè®®

### ğŸ”§ **1. åˆ›å»ºç»Ÿä¸€çš„BallåŸºç¡€ç±»**

```csharp
namespace PongHub.Gameplay.Ball
{
    /// <summary>
    /// çƒçš„ç»Ÿä¸€åŸºç¡€ç±» - æä¾›ç»Ÿä¸€æ¥å£å’Œç»„ä»¶ç®¡ç†
    /// </summary>
    public class Ball : MonoBehaviour
    {
        [Header("æ ¸å¿ƒç»„ä»¶")]
        [SerializeField] private BallPhysics m_physics;
        [SerializeField] private BallNetworking m_networking;
        [SerializeField] private BallSpin m_spin;
        [SerializeField] private BallAttachment m_attachment;
        [SerializeField] private BallStateSync m_stateSync;

        [Header("é…ç½®")]
        [SerializeField] private BallData m_ballData;

        // ç»Ÿä¸€çš„å…¬å…±æ¥å£
        public BallPhysics Physics => m_physics;
        public BallNetworking Networking => m_networking;
        public BallSpin Spin => m_spin;
        public BallAttachment Attachment => m_attachment;
        public BallStateSync StateSync => m_stateSync;
        public BallData Data => m_ballData;

        // ç»Ÿä¸€çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†
        public void Initialize() { /* åˆå§‹åŒ–æ‰€æœ‰ç»„ä»¶ */ }
        public void ResetBall() { /* é‡ç½®æ‰€æœ‰ç»„ä»¶ */ }
        public void DestroyBall() { /* æ¸…ç†æ‰€æœ‰ç»„ä»¶ */ }
    }
}
```

### ğŸ”§ **2. Tableä½œä¸ºçº¯æœ¬åœ°é”šç‚¹**

```csharp
public class Table : MonoBehaviour
{
    [Header("æœ¬åœ°é”šç‚¹è®¾ç½®")]
    [SerializeField] private bool m_isLocalAnchor = true;
    [SerializeField] private Transform m_tableCenter;

    // ç©ºé—´è½¬æ¢åŠŸèƒ½
    public Vector3 WorldToTableSpace(Vector3 worldPosition)
    {
        return transform.InverseTransformPoint(worldPosition);
    }

    public Vector3 TableToWorldSpace(Vector3 tablePosition)
    {
        return transform.TransformPoint(tablePosition);
    }

    // æœ¬åœ°é‡ç½®åŠŸèƒ½
    public void ResetLocalTable()
    {
        // é‡ç½®æœ¬åœ°TableçŠ¶æ€ï¼Œä¸å½±å“å…¶ä»–ç©å®¶
    }
}
```

### ğŸ”§ **3. Ballè´Ÿè´£éŸ³æ•ˆåˆ¤æ–­**

```csharp
// åœ¨Ball.csæˆ–BallPhysics.csä¸­
private void OnCollisionEnter(Collision collision)
{
    if (m_ballIsDead || IsAttached) return;

    var hitObject = collision.gameObject;
    var contact = collision.GetContact(0);
    var hitForce = collision.relativeVelocity.magnitude;

    // çƒè´Ÿè´£åˆ¤æ–­å¹¶æ’­æ”¾ç›¸åº”éŸ³æ•ˆ
    if (hitObject.CompareTag("Table"))
    {
        AudioManager.Instance?.PlayTableHit(contact.point, hitForce);
    }
    else if (hitObject.CompareTag("Net"))
    {
        AudioManager.Instance?.PlayNetHit(contact.point, hitForce);
    }
    else if (hitObject.CompareTag("Paddle"))
    {
        AudioManager.Instance?.PlayPaddleHit(contact.point, hitForce);
    }
    else if (hitObject.CompareTag("Edge"))
    {
        AudioManager.Instance?.PlayEdgeHit(contact.point, hitForce);
    }

    // å¤„ç†å…¶ä»–ç¢°æ’é€»è¾‘...
}
```

## æ¶æ„è®¾è®¡åŸåˆ™

### ğŸ¯ **å•ä¸€èŒè´£åŸåˆ™**

- **Table**: æœ¬åœ°ç©ºé—´é”šç‚¹ + ç¢°æ’æ£€æµ‹
- **Paddle**: ç©å®¶äº¤äº’ + å‡»çƒé€»è¾‘
- **Ball**: ç‰©ç†æ¨¡æ‹Ÿ + ç¢°æ’å“åº” + éŸ³æ•ˆè§¦å‘

### ğŸ”— **æœ€å°ç½‘ç»œå¼€é”€**

- Tableä¸éœ€è¦ç½‘ç»œåŒæ­¥
- éŸ³æ•ˆç”±æœ¬åœ°å®¢æˆ·ç«¯æ ¹æ®ç¢°æ’åˆ¤æ–­æ’­æ”¾
- é¿å…ä¸å¿…è¦çš„RPCè°ƒç”¨

### ğŸ§© **ç»„ä»¶åŒ–è®¾è®¡**

- ä¿æŒç»„ä»¶çš„ä¸“ä¸šåŒ–åˆ†å·¥
- æä¾›ç»Ÿä¸€çš„æ¥å£ç±»è¿›è¡Œæ•´åˆ
- ä¾¿äºæ‰©å±•å’Œç»´æŠ¤

### ğŸ“ **VRç©ºé—´ä¸€è‡´æ€§**

- Tableä½œä¸ºæœ¬åœ°ç‰©ç†ç©ºé—´çš„å‚è€ƒç‚¹
- é€šè¿‡ç›¸å¯¹åæ ‡å®ç°è·¨æˆ¿é—´çš„æ¸¸æˆé€»è¾‘
- æ”¯æŒæˆ¿é—´è§„æ¨¡è¿½è¸ª(Room Scale)çš„å·®å¼‚

## æ€»ç»“

ä½ çš„è§‚å¯Ÿå¾ˆå‡†ç¡®ï¼å½“å‰æ¶æ„ç¡®å®å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

1. **Ballç¼ºä¹ç»Ÿä¸€åŸºç¡€ç±»** - éœ€è¦åˆ›å»ºBall.csä½œä¸ºç»Ÿä¸€æ¥å£
2. **Tableåº”è¯¥ä½œä¸ºæœ¬åœ°é”šç‚¹** - ä¸éœ€è¦ç½‘ç»œåŒæ­¥
3. **éŸ³æ•ˆé€»è¾‘åˆ†æ•£** - åº”è¯¥ç”±Ballç»Ÿä¸€åˆ¤æ–­å’Œè§¦å‘

è¿™äº›æ”¹è¿›å°†ä½¿æ¶æ„æ›´åŠ æ¸…æ™°ã€é«˜æ•ˆå’Œæ˜“äºç»´æŠ¤ã€‚Tableä½œä¸ºæœ¬åœ°ç©ºé—´é”šç‚¹çš„æ¦‚å¿µæ˜¯VRæ¸¸æˆçš„å…³é”®è®¾è®¡ï¼Œåº”è¯¥å¾—åˆ°é‡è§†å’Œæ­£ç¡®å®ç°ã€‚

---

*å»ºè®®ä¼˜å…ˆå®ç°BallåŸºç¡€ç±»çš„ç»Ÿä¸€ï¼Œç„¶åå®Œå–„Tableçš„æœ¬åœ°é”šç‚¹åŠŸèƒ½ã€‚*
